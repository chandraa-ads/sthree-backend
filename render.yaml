services:
  - type: web
    name: sthree-backend
    env: node

    runtime:
      nodeVersion: 20

    buildCommand: npm ci && npm run build
    startCommand: node dist/main.js

    autoDeploy: true

    envVars:
      - key: NODE_ENV
        value: production

      # ✅ Render uses this automatically — defined for clarity
      - key: PORT
        value: 10000

      # ✅ Your frontend app URL (update this)
      - key: FRONTEND_URL
        value: https://sthree-frontend.onrender.com

      # ✅ Supabase database connection (from Supabase Project Settings → Database)
      - key: DATABASE_URL
        sync: false

      # ✅ Optional: Direct database connection (faster migrations)
      - key: DIRECT_URL
        sync: false

      # ✅ Supabase REST API URL (from Supabase Settings → API)
      - key: SUPABASE_URL
        sync: false

      # ✅ Supabase Service Role Key (⚠️ keep secret — from Supabase Settings → API)
      - key: SUPABASE_SERVICE_ROLE_KEY
        sync: false

      # ✅ JWT Secret for NestJS Auth
      - key: JWT_SECRET
        sync: false

      # ✅ Email SMTP credentials
      - key: EMAIL_USER
        sync: false
      - key: EMAIL_PASS
        sync: false
